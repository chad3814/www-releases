

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>lld 14.0.0 Release Notes &#8212; lld 14.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/llvm.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Linker Script implementation notes and policy" href="ELF/linker_script.html" />
    <link rel="prev" title="Partitions" href="Partitions.html" />
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
</style>

  </head><body>
<div class="logo">
<a href="index.html"><img src="_static/logo.png" alt="LLVM Documentation"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ELF/linker_script.html" title="Linker Script implementation notes and policy"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Partitions.html" title="Partitions"
             accesskey="P">previous</a> |</li>
  <li><a href="index.html">lld Home</a>&nbsp;|&nbsp;</li>

        <li class="nav-item nav-item-this"><a href="">lld 14.0.0 Release Notes</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">lld 14.0.0 Release Notes</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#non-comprehensive-list-of-changes-in-this-release">Non-comprehensive list of changes in this release</a><ul>
<li><a class="reference internal" href="#elf-improvements">ELF Improvements</a></li>
<li><a class="reference internal" href="#breaking-changes">Breaking changes</a></li>
<li><a class="reference internal" href="#coff-improvements">COFF Improvements</a></li>
<li><a class="reference internal" href="#mingw-improvements">MinGW Improvements</a></li>
<li><a class="reference internal" href="#mach-o-improvements">Mach-O Improvements</a></li>
<li><a class="reference internal" href="#webassembly-improvements">WebAssembly Improvements</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="Partitions.html"
                        title="previous chapter">Partitions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ELF/linker_script.html"
                        title="next chapter">Linker Script implementation notes and policy</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ReleaseNotes.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lld-release-release-notes">
<h1>lld 14.0.0 Release Notes<a class="headerlink" href="#lld-release-release-notes" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id2">Introduction</a></p></li>
<li><p><a class="reference internal" href="#non-comprehensive-list-of-changes-in-this-release" id="id3">Non-comprehensive list of changes in this release</a></p>
<ul>
<li><p><a class="reference internal" href="#elf-improvements" id="id4">ELF Improvements</a></p></li>
<li><p><a class="reference internal" href="#breaking-changes" id="id5">Breaking changes</a></p></li>
<li><p><a class="reference internal" href="#coff-improvements" id="id6">COFF Improvements</a></p></li>
<li><p><a class="reference internal" href="#mingw-improvements" id="id7">MinGW Improvements</a></p></li>
<li><p><a class="reference internal" href="#mach-o-improvements" id="id8">Mach-O Improvements</a></p></li>
<li><p><a class="reference internal" href="#webassembly-improvements" id="id9">WebAssembly Improvements</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id2">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This document contains the release notes for the lld linker, release 14.0.0.
Here we describe the status of lld, including major improvements
from the previous release. All lld releases may be downloaded
from the <a class="reference external" href="https://llvm.org/releases/">LLVM releases web site</a>.</p>
</div>
<div class="section" id="non-comprehensive-list-of-changes-in-this-release">
<h2><a class="toc-backref" href="#id3">Non-comprehensive list of changes in this release</a><a class="headerlink" href="#non-comprehensive-list-of-changes-in-this-release" title="Permalink to this headline">¶</a></h2>
<div class="section" id="elf-improvements">
<h3><a class="toc-backref" href="#id4">ELF Improvements</a><a class="headerlink" href="#elf-improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--export-dynamic-symbol-list</span></code> has been added.
(<a class="reference external" href="https://reviews.llvm.org/D107317">D107317</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--why-extract</span></code> has been added to query why archive members/lazy object files are extracted.
(<a class="reference external" href="https://reviews.llvm.org/D109572">D109572</a>)</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">-Map</span></code> is specified, <code class="docutils literal notranslate"><span class="pre">--cref</span></code> will be printed to the specified file.
(<a class="reference external" href="https://reviews.llvm.org/D114663">D114663</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-z</span> <span class="pre">bti-report</span></code> and <code class="docutils literal notranslate"><span class="pre">-z</span> <span class="pre">cet-report</span></code> are now supported.
(<a class="reference external" href="https://reviews.llvm.org/D113901">D113901</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--lto-pgo-warn-mismatch</span></code> has been added.
(<a class="reference external" href="https://reviews.llvm.org/D104431">D104431</a>)</p></li>
<li><p>Archives without an index (symbol table) are now supported and work with
<code class="docutils literal notranslate"><span class="pre">--warn-backrefs</span></code>. One may build such an archive with <code class="docutils literal notranslate"><span class="pre">llvm-ar</span> <span class="pre">rcS</span>
<span class="pre">[--thin]</span></code> to save space.
(<a class="reference external" href="https://reviews.llvm.org/D117284">D117284</a>)
The archive index may be <a class="reference external" href="https://reviews.llvm.org/D119074">entirely ignored</a>
in a future release.</p></li>
<li><p>No longer deduplicate local symbol names at the default optimization level of <code class="docutils literal notranslate"><span class="pre">-O1</span></code>.
This results in a larger <code class="docutils literal notranslate"><span class="pre">.strtab</span></code> (usually less than 1%) but a faster link
time. Use optimization level <code class="docutils literal notranslate"><span class="pre">-O2</span></code> to restore the deduplication. The <code class="docutils literal notranslate"><span class="pre">-O2</span></code>
deduplication may be dropped in the future to help parallel <code class="docutils literal notranslate"><span class="pre">.symtab</span></code> write.</p></li>
<li><p>In relocatable output, relocations to discarded symbols now use tombstone
values.
(<a class="reference external" href="https://reviews.llvm.org/D116946">D116946</a>)</p></li>
<li><p>Orphan section placement now picks a more suitable segment. Previously the
algorithm might pick a readonly segment for a writable orphan section and make
the segment writable.
(<a class="reference external" href="https://reviews.llvm.org/D111717">D111717</a>)</p></li>
<li><p>An empty output section moved by an <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> comment now gets appropriate
flags.
(<a class="reference external" href="https://reviews.llvm.org/D118529">D118529</a>)</p></li>
<li><p>Negation in a memory region attribute is now correctly handled.
(<a class="reference external" href="https://reviews.llvm.org/D113771">D113771</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--compress-debug-sections=zlib</span></code> is now run in parallel. <code class="docutils literal notranslate"><span class="pre">{clang,gcc}</span> <span class="pre">-gz</span></code> link
actions are significantly faster.
(<a class="reference external" href="https://reviews.llvm.org/D117853">D117853</a>)</p></li>
<li><p>“relocation out of range” diagnostics and a few uncommon diagnostics
now report an object file location beside a source file location.
(<a class="reference external" href="https://reviews.llvm.org/D117853">D112518</a>)</p></li>
<li><p>The write of <code class="docutils literal notranslate"><span class="pre">.rela.dyn</span></code> and <code class="docutils literal notranslate"><span class="pre">SHF_MERGE|SHF_STRINGS</span></code> sections (e.g.
<code class="docutils literal notranslate"><span class="pre">.debug_str</span></code>) is now run in parallel.</p></li>
</ul>
<p>Architecture specific changes:</p>
<ul class="simple">
<li><p>The AArch64 port now supports adrp+ldr and adrp+add optimizations.
<code class="docutils literal notranslate"><span class="pre">--no-relax</span></code> can suppress the optimization.
(<a class="reference external" href="https://reviews.llvm.org/D112063">D112063</a>)
(<a class="reference external" href="https://reviews.llvm.org/D117614">D117614</a>)</p></li>
<li><p>The x86-32 port now supports TLSDESC (<code class="docutils literal notranslate"><span class="pre">-mtls-dialect=gnu2</span></code>).
(<a class="reference external" href="https://reviews.llvm.org/D112582">D112582</a>)</p></li>
<li><p>The x86-64 port now handles non-RAX/non-adjacent <code class="docutils literal notranslate"><span class="pre">R_X86_64_GOTPC32_TLSDESC</span></code>
and <code class="docutils literal notranslate"><span class="pre">R_X86_64_TLSDESC_CALL</span></code> (<code class="docutils literal notranslate"><span class="pre">-mtls-dialect=gnu2</span></code>).
(<a class="reference external" href="https://reviews.llvm.org/D114416">D114416</a>)</p></li>
<li><p>The x86-32 and x86-64 ports now support mixed TLSDESC and TLS GD, i.e. mixing
objects compiled with and without <code class="docutils literal notranslate"><span class="pre">-mtls-dialect=gnu2</span></code> referencing the same
TLS variable is now supported.
(<a class="reference external" href="https://reviews.llvm.org/D114416">D114416</a>)</p></li>
<li><p>For x86-64, <code class="docutils literal notranslate"><span class="pre">--no-relax</span></code> now suppresses <code class="docutils literal notranslate"><span class="pre">R_X86_64_GOTPCRELX</span></code> and
<code class="docutils literal notranslate"><span class="pre">R_X86_64_REX_GOTPCRELX</span></code> GOT optimization
(<a class="reference external" href="https://reviews.llvm.org/D113615">D113615</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">R_X86_64_PLTOFF64</span></code> is now supported.
(<a class="reference external" href="https://reviews.llvm.org/D112386">D112386</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">R_AARCH64_NONE</span></code>, <code class="docutils literal notranslate"><span class="pre">R_PPC_NONE</span></code>, and <code class="docutils literal notranslate"><span class="pre">R_PPC64_NONE</span></code> in input REL
relocation sections are now supported.</p></li>
</ul>
</div>
<div class="section" id="breaking-changes">
<h3><a class="toc-backref" href="#id5">Breaking changes</a><a class="headerlink" href="#breaking-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">e_entry</span></code> no longer falls back to the address of <code class="docutils literal notranslate"><span class="pre">.text</span></code> if the entry symbol does not exist.
Instead, a value of 0 will be written.
(<a class="reference external" href="https://reviews.llvm.org/D110014">D110014</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--lto-pseudo-probe-for-profiling</span></code> has been removed. In LTO, the compiler
enables this feature automatically.
(<a class="reference external" href="https://reviews.llvm.org/D110209">D110209</a>)</p></li>
<li><p>Use of <code class="docutils literal notranslate"><span class="pre">--[no-]define-common</span></code>, <code class="docutils literal notranslate"><span class="pre">-d</span></code>, <code class="docutils literal notranslate"><span class="pre">-dc</span></code>, and <code class="docutils literal notranslate"><span class="pre">-dp</span></code> will now get a
warning. They will be removed or ignored in 15.0.0.
(<a class="reference external" href="https://github.com/llvm/llvm-project/issues/53660">llvm-project#53660</a>)</p></li>
</ul>
</div>
<div class="section" id="coff-improvements">
<h3><a class="toc-backref" href="#id6">COFF Improvements</a><a class="headerlink" href="#coff-improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Correctly handle a signed immediate offset in ARM64 adr/adrp relocations.
(<a class="reference external" href="https://reviews.llvm.org/D114347">D114347</a>)</p></li>
<li><p>Omit section and label symbols from the symbol table.
(<a class="reference external" href="https://reviews.llvm.org/D113866">D113866</a>)</p></li>
</ul>
</div>
<div class="section" id="mingw-improvements">
<h3><a class="toc-backref" href="#id7">MinGW Improvements</a><a class="headerlink" href="#mingw-improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--heap</span></code> is now handled.
(<a class="reference external" href="https://reviews.llvm.org/D118405">D118405</a>)</p></li>
</ul>
</div>
<div class="section" id="mach-o-improvements">
<h3><a class="toc-backref" href="#id8">Mach-O Improvements</a><a class="headerlink" href="#mach-o-improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">ld64.lld.darwinnew</span></code> symlink has been removed. Use <code class="docutils literal notranslate"><span class="pre">ld64.lld</span></code> to
invoke the Mach-O backend from now on. Moreover, the symlink
<code class="docutils literal notranslate"><span class="pre">ld64.lld.darwinold</span></code> – and the old Mach-O LLD code that it pointed to –
have been removed. (<a class="reference external" href="https://reviews.llvm.org/D114842">D114842</a>)</p></li>
<li><p>The “cannot export hidden symbol” error has been downgraded to a warning.
(<a class="reference external" href="https://reviews.llvm.org/D107011">D107011</a>)</p></li>
<li><p>Common bitcode symbols are now supported.
(<a class="reference external" href="https://reviews.llvm.org/D107027">D107027</a>)</p></li>
<li><p>Weak references in bitcode are now supported.
(<a class="reference external" href="https://reviews.llvm.org/D115949">D115949</a>)</p></li>
<li><p>Thunk insertion now works more reliably.
(<a class="reference external" href="https://reviews.llvm.org/D108897">D108897</a>,
<a class="reference external" href="https://reviews.llvm.org/D108924">D108924</a>,
<a class="reference external" href="https://reviews.llvm.org/D109079">D109079</a>,
<a class="reference external" href="https://reviews.llvm.org/D116705">D116705</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-ObjC</span></code> now loads archive members before the symbol resolution phase.
(<a class="reference external" href="https://reviews.llvm.org/D108781">D108781</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-oso_prefix</span></code> is now supported.
(<a class="reference external" href="https://reviews.llvm.org/D112291">D112291</a>)</p></li>
<li><p>Properly encode binaries with zero exported symbols. Tools like
<code class="docutils literal notranslate"><span class="pre">codesign_allocate</span></code> no longer choke on those binaries.
(<a class="reference external" href="https://reviews.llvm.org/D112589">D112589</a>)</p></li>
<li><p>We no longer treat architecture mismatches as a fatal error. Use
<code class="docutils literal notranslate"><span class="pre">-arch_errors_fatal</span></code> if that behavior is still desired.
(<a class="reference external" href="https://reviews.llvm.org/D113082">D113082</a>)</p></li>
<li><p>Several performance improvements were done to speed LLD up on projects with
a lot of framework flags and library lookups. Large Swift-based projects
will benefit significantly.
(<a class="reference external" href="https://reviews.llvm.org/D113073">D113073</a>,
<a class="reference external" href="https://reviews.llvm.org/D113063">D113063</a>,
<a class="reference external" href="https://reviews.llvm.org/D113153">D113153</a>,
<a class="reference external" href="https://reviews.llvm.org/D113235">D113235</a>)</p></li>
<li><p>Several memory-reduction optimizations were done to reduce LLD’s RSS
footprint.
(<a class="reference external" href="https://reviews.llvm.org/D113813">D113813</a>,
<a class="reference external" href="https://reviews.llvm.org/D113818">D113818</a>)</p></li>
<li><p>Symbol patterns from <code class="docutils literal notranslate"><span class="pre">-[un]exported_symbols_list</span></code> are now processed in
parallel. (<a class="reference external" href="https://reviews.llvm.org/D113820">D113820</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.weak_def_can_be_hidden</span></code> symbols can now be exported.
(<a class="reference external" href="https://reviews.llvm.org/D113167">D113167</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-S</span></code> – to omit debug info – is now handled.
(<a class="reference external" href="https://reviews.llvm.org/D112594">D112594</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-v</span></code> now writes to stderr instead of stdout.
(<a class="reference external" href="https://reviews.llvm.org/D113020">D113020</a>)</p></li>
<li><p>Private externs with GOT relocations are now marked as LOCAL in the indirect
symbol table. This allows <code class="docutils literal notranslate"><span class="pre">strip</span> <span class="pre">-x</span></code> to remove more symbols.
(<a class="reference external" href="https://reviews.llvm.org/D111852">D111852</a>)</p></li>
<li><p>We no longer generate bogus addresses when <code class="docutils literal notranslate"><span class="pre">__TEXT,__gcc_except_tab</span></code> is
renamed. (<a class="reference external" href="https://reviews.llvm.org/D113582">D113582</a>)</p></li>
<li><p>Unreferenced weak dylib symbols no longer trigger fetches from an archive.
(<a class="reference external" href="https://reviews.llvm.org/D115092">D115092</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$ld$hide</span></code> symbols are now supported.
(<a class="reference external" href="https://reviews.llvm.org/D115775">D115775</a>)</p></li>
<li><p>Symbols imported via <code class="docutils literal notranslate"><span class="pre">-weak_framework</span></code> are now properly marked as weak refs.
(<a class="reference external" href="https://reviews.llvm.org/D114397">D114397</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--warn-dylib-install-name</span></code> and <code class="docutils literal notranslate"><span class="pre">--no-warn-dylib-install-name</span></code> were added
to toggle LLD-specific warnings around the use of <code class="docutils literal notranslate"><span class="pre">-install_name</span></code>.
(<a class="reference external" href="https://reviews.llvm.org/D113534">D113534</a>)</p></li>
<li><p>Passing both <code class="docutils literal notranslate"><span class="pre">--icf=all</span></code> and <code class="docutils literal notranslate"><span class="pre">-no_deduplicate</span></code> no longer results in a
warning. (<a class="reference external" href="https://reviews.llvm.org/D110672">D110672</a>)</p></li>
<li><p>ICF now deduplicates functions with (identical) unwind info too.
(<a class="reference external" href="https://reviews.llvm.org/D109946">D109946</a>)</p></li>
<li><p>We now support ordering sections based on call graph profile data.
(<a class="reference external" href="https://reviews.llvm.org/D112164">D112164</a>)</p></li>
<li><p>Map file output now proceeds in parallel with output of the binary.
(<a class="reference external" href="https://reviews.llvm.org/D117069">D117069</a>)</p></li>
<li><p>The map file now contains dead-stripped symbols too.
(<a class="reference external" href="https://reviews.llvm.org/D114737">D114737</a>)</p></li>
<li><p>Multiple TLV sections with different alignments are now handled properly.
(<a class="reference external" href="https://reviews.llvm.org/D116263">D116263</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--start-lib</span></code> and <code class="docutils literal notranslate"><span class="pre">--end-lib</span></code> are now supported.
(<a class="reference external" href="https://reviews.llvm.org/D116913">D116913</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-noall_load</span></code> is now supported.
(<a class="reference external" href="https://reviews.llvm.org/D117629">D117629</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-add_empty_section</span></code> is now supported.
(<a class="reference external" href="https://reviews.llvm.org/D117749">D117749</a>)</p></li>
</ul>
</div>
<div class="section" id="webassembly-improvements">
<h3><a class="toc-backref" href="#id9">WebAssembly Improvements</a><a class="headerlink" href="#webassembly-improvements" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ELF/linker_script.html" title="Linker Script implementation notes and policy"
             >next</a> |</li>
        <li class="right" >
          <a href="Partitions.html" title="Partitions"
             >previous</a> |</li>
  <li><a href="index.html">lld Home</a>&nbsp;|&nbsp;</li>

        <li class="nav-item nav-item-this"><a href="">lld 14.0.0 Release Notes</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2011-2022, LLVM Project.
      Last updated on 2022-03-25.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.1.2.
    </div>
  </body>
</html>