

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>lld 12.0.0 Release Notes &#8212; lld 12 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/llvm.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Linker Script implementation notes and policy" href="ELF/linker_script.html" />
    <link rel="prev" title="Partitions" href="Partitions.html" />
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
</style>

  </head><body>
<div class="logo">
<a href="index.html"><img src="_static/logo.png" alt="LLVM Documentation"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ELF/linker_script.html" title="Linker Script implementation notes and policy"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Partitions.html" title="Partitions"
             accesskey="P">previous</a> |</li>
  <li><a href="index.html">lld Home</a>&nbsp;|&nbsp;</li>

        <li class="nav-item nav-item-this"><a href="">lld 12.0.0 Release Notes</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">lld 12.0.0 Release Notes</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#non-comprehensive-list-of-changes-in-this-release">Non-comprehensive list of changes in this release</a><ul>
<li><a class="reference internal" href="#elf-improvements">ELF Improvements</a></li>
<li><a class="reference internal" href="#breaking-changes">Breaking changes</a></li>
<li><a class="reference internal" href="#coff-improvements">COFF Improvements</a></li>
<li><a class="reference internal" href="#mingw-improvements">MinGW Improvements</a></li>
<li><a class="reference internal" href="#mach-o-improvements">Mach-O Improvements</a></li>
<li><a class="reference internal" href="#webassembly-improvements">WebAssembly Improvements</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="Partitions.html"
                        title="previous chapter">Partitions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ELF/linker_script.html"
                        title="next chapter">Linker Script implementation notes and policy</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ReleaseNotes.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lld-12-0-0-release-notes">
<h1>lld 12.0.0 Release Notes<a class="headerlink" href="#lld-12-0-0-release-notes" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#non-comprehensive-list-of-changes-in-this-release" id="id2">Non-comprehensive list of changes in this release</a></p>
<ul>
<li><p><a class="reference internal" href="#elf-improvements" id="id3">ELF Improvements</a></p></li>
<li><p><a class="reference internal" href="#breaking-changes" id="id4">Breaking changes</a></p></li>
<li><p><a class="reference internal" href="#coff-improvements" id="id5">COFF Improvements</a></p></li>
<li><p><a class="reference internal" href="#mingw-improvements" id="id6">MinGW Improvements</a></p></li>
<li><p><a class="reference internal" href="#mach-o-improvements" id="id7">Mach-O Improvements</a></p></li>
<li><p><a class="reference internal" href="#webassembly-improvements" id="id8">WebAssembly Improvements</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>These are in-progress notes for the upcoming LLVM 12.0.0 release.
Release notes for previous releases can be found on
<a class="reference external" href="https://releases.llvm.org/download.html">the Download Page</a>.</p>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id1">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This document contains the release notes for the lld linker, release 12.0.0.
Here we describe the status of lld, including major improvements
from the previous release. All lld releases may be downloaded
from the <a class="reference external" href="https://llvm.org/releases/">LLVM releases web site</a>.</p>
</div>
<div class="section" id="non-comprehensive-list-of-changes-in-this-release">
<h2><a class="toc-backref" href="#id2">Non-comprehensive list of changes in this release</a><a class="headerlink" href="#non-comprehensive-list-of-changes-in-this-release" title="Permalink to this headline">¶</a></h2>
<div class="section" id="elf-improvements">
<h3><a class="toc-backref" href="#id3">ELF Improvements</a><a class="headerlink" href="#elf-improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--dependency-file</span></code> has been added. (Similar to <code class="docutils literal notranslate"><span class="pre">cc</span> <span class="pre">-M</span> <span class="pre">-MF</span></code>.)
(<a class="reference external" href="https://reviews.llvm.org/D82437">D82437</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--error-handling-script</span></code> has been added to allow for user-defined handlers upon
missing libraries. (<a class="reference external" href="https://reviews.llvm.org/D87758">D87758</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--exclude-libs</span></code> can now localize defined version symbols and bitcode referenced libcall symbols.
(<a class="reference external" href="https://reviews.llvm.org/D94280">D94280</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--gdb-index</span></code> now works with DWARF v5 and <code class="docutils literal notranslate"><span class="pre">--icf={safe,all}</span></code>.
(<a class="reference external" href="https://reviews.llvm.org/D85579">D85579</a>)
(<a class="reference external" href="https://reviews.llvm.org/D89751">D89751</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--gdb-index</span> <span class="pre">--emit-relocs</span></code> can now be used together.
(<a class="reference external" href="https://reviews.llvm.org/D94354">D94354</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--icf={safe,all}</span></code> conservatively no longer fold text sections with LSDA.
Previously ICF on <code class="docutils literal notranslate"><span class="pre">-fexceptions</span></code> code could be unsafe.
(<a class="reference external" href="https://reviews.llvm.org/D84610">D84610</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--icf={safe,all}</span></code> can now fold two sections with relocations referencing aliased symbols.
(<a class="reference external" href="https://reviews.llvm.org/D88830">D88830</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--lto-pseudo-probe-for-profiling</span></code> has been added.
(<a class="reference external" href="https://reviews.llvm.org/D95056">D95056</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--no-lto-whole-program-visibility</span></code> has been added.
(<a class="reference external" href="https://reviews.llvm.org/D92060">D92060</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--oformat-binary</span></code> has been fixed to respect LMA.
(<a class="reference external" href="https://reviews.llvm.org/D85086">D85086</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--reproduce</span></code> includes <code class="docutils literal notranslate"><span class="pre">--lto-sample-profile</span></code>, <code class="docutils literal notranslate"><span class="pre">--just-symbols</span></code>, <code class="docutils literal notranslate"><span class="pre">--call-graph-ordering-file</span></code>, <code class="docutils literal notranslate"><span class="pre">--retain-symbols-file</span></code> files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-r</span> <span class="pre">--gc-sections</span></code> is now supported.
(<a class="reference external" href="https://reviews.llvm.org/D84131">D84131</a>)</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">-u</span></code> specified symbol will no longer change the binding to <code class="docutils literal notranslate"><span class="pre">STB_WEAK</span></code>.
(<a class="reference external" href="https://reviews.llvm.org/D88945">D88945</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--wrap</span></code> support has been improved.
+ If <code class="docutils literal notranslate"><span class="pre">foo</span></code> is not referenced, there is no longer an undefined symbol <code class="docutils literal notranslate"><span class="pre">__wrap_foo</span></code>.
+ If <code class="docutils literal notranslate"><span class="pre">__real_foo</span></code> is not referenced, there is no longer an undefined symbol <code class="docutils literal notranslate"><span class="pre">foo</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SHF_LINK_ORDER</span></code> sections can now have zero <code class="docutils literal notranslate"><span class="pre">sh_link</span></code> values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SHF_LINK_ORDER</span></code> and non-<code class="docutils literal notranslate"><span class="pre">SHF_LINK_ORDER</span></code> sections can now be mixed within an input section description.
(<a class="reference external" href="https://reviews.llvm.org/D84001">D84001</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LOG2CEIL</span></code> is now supported in linker scripts.
(<a class="reference external" href="https://reviews.llvm.org/D84054">D84054</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DEFINED</span></code> has been fixed to check whether the symbol is defined.
(<a class="reference external" href="https://reviews.llvm.org/D83758">D83758</a>)</p></li>
<li><p>An input section description may now have multiple <code class="docutils literal notranslate"><span class="pre">SORT_*</span></code>.
The matched sections are ordered by radix sort with the keys being <code class="docutils literal notranslate"><span class="pre">(SORT*,</span> <span class="pre">--sort-section,</span> <span class="pre">input</span> <span class="pre">order)</span></code>.
(<a class="reference external" href="https://reviews.llvm.org/D91127">D91127</a>)</p></li>
<li><p>Users can now provide a GNU style linker script to convert <code class="docutils literal notranslate"><span class="pre">.ctors</span></code> into <code class="docutils literal notranslate"><span class="pre">.init_array</span></code>.
(<a class="reference external" href="https://reviews.llvm.org/D91187">D91187</a>)</p></li>
<li><p>An empty output section can now be discarded even if it is assigned to a program header.
(<a class="reference external" href="https://reviews.llvm.org/D92301">D92301</a>)</p></li>
<li><p>Non-<code class="docutils literal notranslate"><span class="pre">SHF_ALLOC</span></code> sections now have larger file offsets than <code class="docutils literal notranslate"><span class="pre">SHF_ALLOC</span></code> sections.
(<a class="reference external" href="https://reviews.llvm.org/D85867">D85867</a>)</p></li>
<li><p>Some symbol versioning improvements.
+ Defined <code class="docutils literal notranslate"><span class="pre">foo&#64;&#64;v1</span></code> now resolve undefined <code class="docutils literal notranslate"><span class="pre">foo&#64;v1</span></code> (<a class="reference external" href="https://reviews.llvm.org/D92259">D92259</a>)
+ Undefined <code class="docutils literal notranslate"><span class="pre">foo&#64;v1</span></code> now gets an error (<a class="reference external" href="https://reviews.llvm.org/D92260">D92260</a>)</p></li>
<li><p>The AArch64 port now has support for <code class="docutils literal notranslate"><span class="pre">STO_AARCH64_VARIANT_PCS</span></code> and <code class="docutils literal notranslate"><span class="pre">DT_AARCH64_VARIANT_PCS</span></code>.
(<a class="reference external" href="https://reviews.llvm.org/D93045">D93045</a>)</p></li>
<li><p>The AArch64 port now has support for <code class="docutils literal notranslate"><span class="pre">R_AARCH64_LD64_GOTPAGE_LO15</span></code>.</p></li>
<li><p>The PowerPC64 port now detects missing R_PPC64_TLSGD/R_PPC64_TLSLD and disables TLS relaxation.
This allows linking with object files produced by very old IBM XL compilers.
(<a class="reference external" href="https://reviews.llvm.org/D92959">D92959</a>)</p></li>
<li><p>Many PowerPC PC-relative relocations are now supported.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">R_PPC_ADDR24</span></code> and <code class="docutils literal notranslate"><span class="pre">R_PPC64_ADDR16_HIGH</span></code> are now supported.</p></li>
<li><p>powerpcle is now supported. Tested with FreeBSD loader and freestanding.
(<a class="reference external" href="https://reviews.llvm.org/D93917">D93917</a>)</p></li>
<li><p>RISC-V: the first <code class="docutils literal notranslate"><span class="pre">SHT_RISCV_ATTRIBUTES</span></code> section is now retained.
(<a class="reference external" href="https://reviews.llvm.org/D86309">D86309</a>)</p></li>
<li><p>LTO pipeline now defaults to the new PM if the CMake variable <code class="docutils literal notranslate"><span class="pre">ENABLE_EXPERIMENTAL_NEW_PASS_MANAGER</span></code> is on.
(<a class="reference external" href="https://reviews.llvm.org/D92885">D92885</a>)</p></li>
</ul>
</div>
<div class="section" id="breaking-changes">
<h3><a class="toc-backref" href="#id4">Breaking changes</a><a class="headerlink" href="#breaking-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>A COMMON symbol can now cause the fetch of an archive providing a <code class="docutils literal notranslate"><span class="pre">STB_GLOBAL</span></code> definition.
This behavior follows GNU ld newer than December 1999.
If you see <code class="docutils literal notranslate"><span class="pre">duplicate</span> <span class="pre">symbol</span></code> errors with the new behavior, check out <a class="reference external" href="https://bugs.llvm.org//show_bug.cgi?id=49226">PR49226</a>.
(<a class="reference external" href="https://reviews.llvm.org/D86142">D86142</a>)</p></li>
</ul>
</div>
<div class="section" id="coff-improvements">
<h3><a class="toc-backref" href="#id5">COFF Improvements</a><a class="headerlink" href="#coff-improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Error out clearly if creating a DLL with too many exported symbols.
(<a class="reference external" href="https://reviews.llvm.org/D86701">D86701</a>)</p></li>
</ul>
</div>
<div class="section" id="mingw-improvements">
<h3><a class="toc-backref" href="#id6">MinGW Improvements</a><a class="headerlink" href="#mingw-improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Enabled dynamicbase by default. (<a class="reference external" href="https://reviews.llvm.org/D86654">D86654</a>)</p></li>
<li><p>Tolerate mismatches between COMDAT section sizes with different amount of
padding (produced by binutils) by inspecting the aux section definition.
(<a class="reference external" href="https://reviews.llvm.org/D86659">D86659</a>)</p></li>
<li><p>Support setting the subsystem version via the subsystem argument.
(<a class="reference external" href="https://reviews.llvm.org/D88804">D88804</a>)</p></li>
<li><p>Implemented the GNU -wrap option.
(<a class="reference external" href="https://reviews.llvm.org/D89004">D89004</a>,
<a class="reference external" href="https://reviews.llvm.org/D91689">D91689</a>)</p></li>
<li><p>Handle the <code class="docutils literal notranslate"><span class="pre">--demangle</span></code> and <code class="docutils literal notranslate"><span class="pre">--no-demangle</span></code> options.
(<a class="reference external" href="https://reviews.llvm.org/D93950">D93950</a>)</p></li>
</ul>
</div>
<div class="section" id="mach-o-improvements">
<h3><a class="toc-backref" href="#id7">Mach-O Improvements</a><a class="headerlink" href="#mach-o-improvements" title="Permalink to this headline">¶</a></h3>
<p>We’ve gotten the new implementation of LLD for Mach-O to the point where it is
able to link large x86_64 programs, and we’d love to get some alpha testing on
it. The new Darwin back-end can be invoked as follows:</p>
<p>To reach this point, we implemented numerous features, and it’s easier to list
the major features we <em>haven’t</em> yet completed:</p>
<ul class="simple">
<li><p>LTO support</p></li>
<li><p>Stack unwinding for exceptions</p></li>
<li><p>Support for arm64, arm, and i386 architectures</p></li>
</ul>
<p>If you stumble upon an issue and it doesn’t fall into one of these categories,
please file a bug report!</p>
</div>
<div class="section" id="webassembly-improvements">
<h3><a class="toc-backref" href="#id8">WebAssembly Improvements</a><a class="headerlink" href="#webassembly-improvements" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ELF/linker_script.html" title="Linker Script implementation notes and policy"
             >next</a> |</li>
        <li class="right" >
          <a href="Partitions.html" title="Partitions"
             >previous</a> |</li>
  <li><a href="index.html">lld Home</a>&nbsp;|&nbsp;</li>

        <li class="nav-item nav-item-this"><a href="">lld 12.0.0 Release Notes</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2011-2021, LLVM Project.
      Last updated on 2021-07-09.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
    </div>
  </body>
</html>